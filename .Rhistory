ggplot(aes(x=Category, y=Percent)) +
geom_point(col="tomato", size=3) +   # Draw points
geom_segment(aes(x=Category,
xend=Category,
y=min(Percent),
yend=max(Percent)),
linetype="dashed",
size=0.1) + theme_minimal()+  # Draw dashed lines
coord_flip()+scale_color_aaas()+scale_x_discrete(labels=labels.INT, name="")
#Subsetting ----
#Select where respondents have assigned items to at least 1 category
data <- data %>%
mutate(ans = ifelse(is.na(universals_sorting_0_GROUP) & is.na(universals_sorting_1_GROUP) & is.na(universals_sorting_2_GROUP) & is.na(universals_sorting_3_GROUP), 0, 1))
for (i in 1:nrow(data)){
data$NEmpty[i] <- sum(is.na(data[i,c("universals_sorting_0_GROUP","universals_sorting_1_GROUP","universals_sorting_2_GROUP", "universals_sorting_3_GROUP")]))
}
Univ <- data %>%
filter(!is.na(wisdom_culture)|
!is.na(universals_sorting_0_GROUP) |
!is.na(universals_sorting_1_GROUP) |
!is.na(universals_sorting_2_GROUP) |
!is.na(universals_sorting_3_GROUP)) %>%
filter(ResponseId !="R_2XdqUYSGdFotixV")  %>%
select(country,ResponseId,field,prior_research:position_8_TEXT,
universals_sorting_0_GROUP:universals_sorting_3_17_RANK)
Univ <- Univ %>% mutate(across(universals_sorting_0_1_RANK:universals_sorting_3_17_RANK, ~ ifelse(is.na(.x), 0, .x)))
univ2 <- Univ %>% select(ResponseId,universals_sorting_0_1_RANK:universals_sorting_3_17_RANK)%>%
pivot_longer(names_to = "Group", values_to = "Rank",   universals_sorting_0_1_RANK:universals_sorting_3_17_RANK) %>%
mutate(Group2 = ifelse(str_detect(Group,"universals_sorting_0"), "Non-Universals", Group)) %>%
mutate(Group2 = ifelse(str_detect(Group,"universals_sorting_1"), "Existential Universal", Group2)) %>%
mutate(Group2 = ifelse(str_detect(Group,"universals_sorting_2"), "Functional Universal", Group2)) %>%
mutate(Group2 = ifelse(str_detect(Group,"universals_sorting_3"), "Accessibility Universal", Group2))%>%
mutate(Item = substr(Group, start=22,stop=23))
univ2$Item <- str_remove(univ2$Item, pattern = "_")
univ2$Item <- as.numeric(univ2$Item)
```{r}
#Getting overall frequencies ----
univ2 <- univ2 %>%
mutate(selected = ifelse(Rank != 0, 1, 0))
univ2$Group2 <- as.factor(univ2$Group2)
univ2$Item <- as.factor(univ2$Item)
str(univ2)
labelsItems<-c(
"1" = "Epistemic Humility",
"2" = "Open-mindedness\nDiverse perspectives",
"3" = "Equanimity\nSelf-control",
"4" = "Context-sensitivity",
"5" = "Self-transcendence",
"6" = "Deliberation\nReflection",
"7" ="Realization of\nshared humanity",
"8" = "Pursuit of truth",
"9" = "In-group cooperation",
"10" = "Sympathy\ncompassion",
"11" = "Balance diverse interests",
"12" = "Experiential knowledge",
"13" = "Uncertainty management",
"14" ="Declarative (book) knowledge",
"15" = "Seeking Insight\nMeaning",
"16" = "Self-compassion",
"17" = "Humor" )
universal.total.Summary<-univ2 %>%
group_by(Item) %>%
summarise(Prop = sum(selected, na.rm=T)/length(unique(ResponseId))) %>%
mutate(Percent = Prop*100) %>%
ungroup() %>%  arrange(Percent) %>%
mutate(Item=factor(Item, levels=Item)) %>%
ggplot(aes(x=Item, y=Percent)) +
geom_point(size=3) +   # Draw points
geom_segment(aes(x=Item,
xend=Item,
y=min(Percent),
yend=max(Percent)),
linetype="dashed",
size=0.1) + theme_minimal()+  # Draw dashed lines
coord_flip()+scale_color_aaas()+scale_x_discrete(labels=labelsItems, name="")
print(universal.total.Summary)
universal.bygroup.Summary<-univ2 %>%
group_by(Group2,Item) %>%
summarise(Prop = mean(selected, na.rm=T)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Group2,Percent) %>% group_by(Group2) %>%
mutate(Item=factor(Item, levels=Item)) %>%
ggplot(aes(x=Item, y=Percent, color=Group2)) +
geom_point(size=3) +   # Draw points
geom_segment(aes(x=Item,
xend=Item,
y=min(Percent),
yend=max(Percent)),
linetype="dashed",
size=0.1) + theme_minimal()+ facet_wrap(vars(Group2))+
coord_flip()+scale_color_aaas()+scale_x_discrete(labels=labelsItems, name="")+theme(legend.position="none")
culture.by.group <- univ2 %>%
group_by(Group2,Item) %>%
summarise(Prop = mean(selected, na.rm=T)) %>%
mutate(Percent = Prop*100) %>%
# 1. Remove grouping
ungroup() %>%
# 2. Arrange by
#   i.  facet group
#   ii. bar height
arrange(Group2, Percent) %>%
# 3. Add order column of row numbers
mutate(order = row_number()) %>% mutate(Item=recode_factor(Item, "1" = "Epistemic Humility",
"2" = "Open-mindedness\nDiverse perspectives",
"3" = "Equanimity\nSelf-control",
"4" = "Context-sensitivity",
"5" = "Self-transcendence",
"6" = "Deliberation\nReflection",
"7" ="Realization of\nshared humanity",
"8" = "Pursuit of truth",
"9" = "In-group cooperation",
"10" = "Sympathy\ncompassion",
"11" = "Balance diverse interests",
"12" = "Experiential knowledge",
"13" = "Uncertainty management",
"14" ="Declarative (book) knowledge",
"15" = "Seeking Insight\nMeaning",
"16" = "Self-compassion",
"17" = "Humor" ))
#lollipop chart
culture.by.group %>% ggplot(aes(x=order, y=Percent, color=Group2)) +
geom_point(size=3) +
geom_segment(aes(x=order,
xend=order,
y=0,
yend=Percent)) +facet_wrap(vars(Group2), scales = "free")+
scale_x_continuous(   # Add categories to axis
breaks = culture.by.group$order,
labels = culture.by.group$Item)+theme_minimal(base_size = 14) +theme(legend.position="none")+
scale_color_aaas()+theme(axis.text.x = element_text(angle=90, vjust=0.5))+labs(x="")+ coord_flip()
#Getting Ranks ----
univ2$Rank <- as.numeric(univ2$Rank)
univ2 <- univ2 %>%
mutate(Rank_place = ifelse(Rank != 0, Rank, 18))
culture.by.group.ranked <- univ2 %>%
group_by(Group2,Item) %>%
summarise(Rank = mean(Rank_place, na.rm=T))  %>%
# 1. Remove grouping
ungroup() %>%
# 2. Arrange by
#   i.  facet group
#   ii. bar height
arrange(Group2, desc(Rank)) %>%
# 3. Add order column of row numbers
mutate(order = row_number()) %>% mutate(Item=recode_factor(Item, "1" = "Epistemic Humility",
"2" = "Open-mindedness\nDiverse perspectives",
"3" = "Equanimity\nSelf-control",
"4" = "Context-sensitivity",
"5" = "Self-transcendence",
"6" = "Deliberation\nReflection",
"7" ="Realization of\nshared humanity",
"8" = "Pursuit of truth",
"9" = "In-group cooperation",
"10" = "Sympathy\ncompassion",
"11" = "Balance diverse interests",
"12" = "Experiential knowledge",
"13" = "Uncertainty management",
"14" ="Declarative (book) knowledge",
"15" = "Seeking Insight\nMeaning",
"16" = "Self-compassion",
"17" = "Humor" ))
#lollipop chart
culture.by.group.ranked %>% ggplot(aes(x=order, y=Rank, color=Group2)) +
geom_point(size=3) +
geom_segment(aes(x=order,
xend=order,
y=0,
yend=Rank)) +facet_wrap(vars(Group2), scales = "free")+
scale_x_continuous(   # Add categories to axis
breaks = culture.by.group.ranked$order,
labels = culture.by.group.ranked$Item)+theme_minimal(base_size = 14) +theme(legend.position="none")+
scale_color_aaas()+theme(axis.text.x = element_text(angle=90, vjust=0.5))+labs(y="Average Rank (1-18)",x="")+ coord_flip()
Culture.open <- data %>%
filter(!is.na(AR_FINAL)) %>%
select(CountryCode,Progress, Duration,position2,ResponseId,field,prior_research:education,wisdom_culture,AR_FINAL,
U_FINAL,MBR_FINAL,CCOMPETENCE_FINAL) %>%
rename(Position = position2, Education = education, Field = field)
pd <- position_dodge(0.7) # move them .07 to the left and right
labels.culture<-c(
AR_FINAL = "Absolute relativism ",
U_FINAL = "Universalism",
MBR_FINAL = "Morally-bounded relativism",
CCOMPETENCE_FINAL = "Wisdom as a cultural competence")
Culture.open.Summary<-Culture.open.long %>%
group_by(Category) %>%
summarise(Prop = mean(Score, na.rm=T)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Percent)
Culture.open <- data %>%
filter(!is.na(AR_FINAL)) %>%
select(CountryCode,Progress, Duration,position2,ResponseId,field,prior_research:education,wisdom_culture,AR_FINAL,
U_FINAL,MBR_FINAL,CCOMPETENCE_FINAL) %>%
rename(Position = position2, Education = education, Field = field)
pd <- position_dodge(0.7) # move them .07 to the left and right
labels.culture<-c(
AR_FINAL = "Absolute relativism ",
U_FINAL = "Universalism",
MBR_FINAL = "Morally-bounded relativism",
CCOMPETENCE_FINAL = "Wisdom as a cultural competence")
#how many responses?
length(Culture.open$AR_FINAL)
Culture.open.long<-Culture.open %>% pivot_longer(AR_FINAL:CCOMPETENCE_FINAL,names_to="Category",values_to="Score")
Culture.open.Summary<-Culture.open.long %>%
group_by(Category) %>%
summarise(Prop = mean(Score, na.rm=T)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Percent)
Culture.open.Summary %>% arrange(Percent) %>%
mutate(Category=factor(Category, levels=Category)) %>%
ggplot(aes(x=Category, y=Percent)) +
geom_point(col="tomato2", size=3) +   # Draw points
geom_segment(aes(x=Category,
xend=Category,
y=min(Percent),
yend=max(Percent)),
linetype="dashed",
size=0.1) + theme_minimal()+  # Draw dashed lines
coord_flip()+scale_color_aaas()+scale_x_discrete(labels=labels.culture, name="")
mmary %>% arrange(Percent) %>%
mutate(Category=factor(Category, levels=Category)) %>%
ggplot(aes(x=Category, y=Percent)) +
geom_point(col="tomato2", size=3) +   # Draw points
geom_segment(aes(x=Category,
xend=Category,
y=min(Percent),
yend=max(Percent)),
linetype="dashed",
size=0.1) + theme_minimal()+  # Draw dashed lines
coord_flip()+scale_color_aaas()+scale_x_discrete(labels=labels.culture, name="")
Culture.open.Summary %>% arrange(Percent) %>%
mutate(Category=factor(Category, levels=Category)) %>%
ggplot(aes(x=Category, y=Percent)) +
geom_point(col="blue", size=3) +   # Draw points
geom_segment(aes(x=Category,
xend=Category,
y=min(Percent),
yend=max(Percent)),
linetype="dashed",
size=0.1) + theme_minimal()+  # Draw dashed lines
coord_flip()+scale_color_aaas()+scale_x_discrete(labels=labels.culture, name="")
CWM.open <- data %>%
filter(!is.na(wisdomModelFamiliar) | !is.na(PMC_FINAL) |!is.na(wisdom_culture)) %>%
select(CountryCode,Progress, Duration,position2,ResponseId,field,prior_research:education,wisdomModelFamiliar,
PMC_FINAL,Morals_Prosocial_FINAL,Integration.of.Morals_PMC_FINAL,
morality_irrelevant_FINAL,lacks_moral_behaviour_FINAL,Variable_process_engagement_FINAL,
Ignores_emotion_FINAL,Needs_behaviour_FINAL,no_contemplative_traditions_FINAL) %>%
rename(Position = position2, Education = education, Field = field)
CWM.open <- data.filter %>%
filter(!is.na(wisdomModelFamiliar) | !is.na(PMC_FINAL) |!is.na(wisdom_culture)) %>%
select(CountryCode,Progress, Duration,position2,ResponseId,field,prior_research:education,wisdomModelFamiliar,
PMC_FINAL,Morals_Prosocial_FINAL,Integration.of.Morals_PMC_FINAL,
morality_irrelevant_FINAL,lacks_moral_behaviour_FINAL,Variable_process_engagement_FINAL,
Ignores_emotion_FINAL,Needs_behaviour_FINAL,no_contemplative_traditions_FINAL) %>%
rename(Position = position2, Education = education, Field = field)
CWM.open <- data %>%
data %>%
filter(!is.na(morality_wis_analogy) |
!is.na(moral_wis_comments) |
!is.na(wis_psych_char) |
!is.na(model_agreement) |
!is.na(model_disagree) |
!is.na(wisdom_culture)|
!is.na(comments)|!is.na(wisdomModelFamiliar) | !is.na(PMC_FINAL) ) %>%
select(CountryCode,Progress, Duration,position2,ResponseId,field,prior_research:education,wisdomModelFamiliar,
PMC_FINAL,Morals_Prosocial_FINAL,Integration.of.Morals_PMC_FINAL,
morality_irrelevant_FINAL,lacks_moral_behaviour_FINAL,Variable_process_engagement_FINAL,
Ignores_emotion_FINAL,Needs_behaviour_FINAL,no_contemplative_traditions_FINAL) %>%
rename(Position = position2, Education = education, Field = field)
CWM.open <- data %>%
filter(!is.na(morality_wis_analogy) |
!is.na(moral_wis_comments) |
!is.na(wis_psych_char) |
!is.na(model_agreement) |
!is.na(model_disagree) |
!is.na(wisdom_culture)|
!is.na(comments)|!is.na(wisdomModelFamiliar) | !is.na(PMC_FINAL) ) %>%
select(CountryCode,Progress, Duration,position2,ResponseId,field,prior_research:education,wisdomModelFamiliar,
PMC_FINAL,Morals_Prosocial_FINAL,Integration.of.Morals_PMC_FINAL,
morality_irrelevant_FINAL,lacks_moral_behaviour_FINAL,Variable_process_engagement_FINAL,
Ignores_emotion_FINAL,Needs_behaviour_FINAL,no_contemplative_traditions_FINAL) %>%
rename(Position = position2, Education = education, Field = field)
CWM.open <- data %>%
filter(!is.na(wisdomModelFamiliar) | !is.na(PMC_FINAL) ) %>%
select(CountryCode,Progress, Duration,position2,ResponseId,field,prior_research:education,wisdomModelFamiliar,
PMC_FINAL,Morals_Prosocial_FINAL,Integration.of.Morals_PMC_FINAL,
morality_irrelevant_FINAL,lacks_moral_behaviour_FINAL,Variable_process_engagement_FINAL,
Ignores_emotion_FINAL,Needs_behaviour_FINAL,no_contemplative_traditions_FINAL) %>%
rename(Position = position2, Education = education, Field = field)
table(CWM.open$wisdomModelFamiliar)
prop.table(table(CWM.open$wisdomModelFamiliar))
pd <- position_dodge(0.7) # move them .07 to the left and right
labels.CWM<-c(
PMC_FINAL = "Agree: Metacognition/deliberative components\nMetacognition, Insight, Integration, Perspective-taking, Intellectual Humility",
Morals_Prosocial_FINAL = "Agree: Morals/prosocial features ",
Integration.of.Morals_PMC_FINAL = "Agree: Integration of morals and metacognition",
morality_irrelevant_FINAL = "Critique: Morality is irrelevant\ncomes only at the end ",
lacks_moral_behaviour_FINAL = "Critique: Not enough morality",
Variable_process_engagement_FINAL = "Critique: Variability in processes unspecified",
Ignores_emotion_FINAL = "Critique: Ignores the role of emotion (regulation)",
Needs_behaviour_FINAL = "Critique: Needs behavioural skills",
no_contemplative_traditions_FINAL = "Critique: Lack of contemplative traditions")
#how many responses?
length(na.omit(CWM.open$PMC_FINAL))
CWM.open.long<-CWM.open %>% pivot_longer(PMC_FINAL:no_contemplative_traditions_FINAL,names_to="Category",values_to="Score")
CWM.open.Summary<-CWM.open.long %>%
group_by(Category) %>%
summarise(Prop = mean(Score, na.rm=T)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Percent)
CWM.open.Summary %>% arrange(Percent) %>%
mutate(Category=factor(Category, levels=Category)) %>%
ggplot(aes(x=Category, y=Percent)) +
geom_point(col="tomato2", size=3) +   # Draw points
geom_segment(aes(x=Category,
xend=Category,
y=min(Percent),
yend=max(Percent)),
linetype="dashed",
size=0.1) + theme_minimal()+  # Draw dashed lines
coord_flip()+scale_color_aaas()+scale_x_discrete(labels=labels.CWM, name="")
CWM.open.Summary %>% arrange(Percent) %>%
mutate(Category=factor(Category, levels=Category)) %>%
ggplot(aes(x=Category, y=Percent)) +
geom_point(col="tomato2", size=3) +   # Draw points
geom_segment(aes(x=Category,
xend=Category,
y=min(Percent),
yend=max(Percent)),
linetype="dashed",
size=0.1) + theme_minimal()+  # Draw dashed lines
coord_flip()+scale_color_aaas()+scale_x_discrete(labels=labels.CWM, name="")
CWM.open.Summary %>% arrange(Percent) %>%
mutate(Category=factor(Category, levels=Category)) %>%
ggplot(aes(x=Category, y=Percent)) +
geom_point( size=3) +   # Draw points
geom_segment(aes(x=Category,
xend=Category,
y=min(Percent),
yend=max(Percent)),
linetype="dashed",
size=0.1) + theme_minimal()+  # Draw dashed lines
coord_flip()+scale_color_aaas()+scale_x_discrete(labels=labels.CWM, name="")
ggplot(data.filter, aes(x = country)) + geom_histogram(stat="count")+coord_flip()
data.filter%>%
group_by(country) %>%
summarise(tally = n()) %>%
arrange(desc(tally))
ggplot(data.filter, aes(x = country)) + geom_histogram(stat="count")+coord_flip()
data.filter%>%
group_by(position) %>%
summarise(tally = n()) %>%
arrange(desc(tally))
ggplot(data.filter, aes(x = position)) + geom_histogram(stat="count")+coord_flip()
data.filter$Position
table(data.filter$Position)
#field
data.filter%>%
group_by(Field) %>%
summarise(tally = n()) %>%
arrange(desc(tally))
data.field <- data.filter %>%
mutate(Social = ifelse(str_detect(Field, "Social Psychology"), 1, 0))%>%
mutate(Moral_Psychology = ifelse(str_detect(Field, "Moral Psychology"), 1, 0))%>%
mutate(Wisdom = ifelse(str_detect(Field, "Wisdom"), 1, 0))%>%
mutate(Clinical = ifelse(str_detect(Field, "Clinical"), 1, 0))%>%
mutate(Personality  = ifelse(str_detect(Field, "Personality"), 1, 0))%>%
mutate(Education = ifelse(str_detect(Field, "Education"), 1, 0))%>%
mutate(Developmental = ifelse(str_detect(Field, "Developmental"), 1, 0))%>%
mutate(CogSci = ifelse(str_detect(Field, "Cognitive Science"), 1, 0))%>%
mutate(Cognitive = ifelse(str_detect(Field, "Cognitive Psychology"), 1, 0))%>%
mutate(Quantitative = ifelse(str_detect(Field, "Quantitative Psychology"), 1, 0))%>%
mutate(Evolutionary = ifelse(str_detect(Field, "Evolutionary Psychology"), 1, 0))%>%
mutate(Moral_philosophy = ifelse(str_detect(Field, "Moral philosophy"), 1, 0))%>%
mutate(Evolutionary = ifelse(str_detect(Field, "Evolutionary Psychology"), 1, 0)))
data.field <- data.filter %>%
mutate(Social = ifelse(str_detect(Field, "Social Psychology"), 1, 0))%>%
mutate(Moral_Psychology = ifelse(str_detect(Field, "Moral Psychology"), 1, 0))%>%
mutate(Wisdom = ifelse(str_detect(Field, "Wisdom"), 1, 0))%>%
mutate(Clinical = ifelse(str_detect(Field, "Clinical"), 1, 0))%>%
mutate(Personality  = ifelse(str_detect(Field, "Personality"), 1, 0))%>%
mutate(Education = ifelse(str_detect(Field, "Education"), 1, 0))%>%
mutate(Developmental = ifelse(str_detect(Field, "Developmental"), 1, 0))%>%
mutate(CogSci = ifelse(str_detect(Field, "Cognitive Science"), 1, 0))%>%
mutate(Cognitive = ifelse(str_detect(Field, "Cognitive Psychology"), 1, 0))%>%
mutate(Quantitative = ifelse(str_detect(Field, "Quantitative Psychology"), 1, 0))%>%
mutate(Evolutionary = ifelse(str_detect(Field, "Evolutionary Psychology"), 1, 0))%>%
mutate(Moral_philosophy = ifelse(str_detect(Field, "Moral philosophy"), 1, 0))%>%
mutate(Evolutionary = ifelse(str_detect(Field, "Evolutionary Psychology"), 1, 0))
data.field.long<-data.field %>% pivot_longer(Social:Evolutionary,names_to="Field",values_to="Proportion")
names(data.field)
data.field.long<-data.field %>% pivot_longer(Social:Moral_philosophy,names_to="Field",values_to="Proportion")
View(data.field)
data.field.long<-data.field %>% pivot_longer(cols = Social:Moral_philosophy,names_to=Field,values_to=Proportion)
"
data.field.long<-data.field %>% pivot_longer(cols = Social:Moral_philosophy,names_to="Field",values_to="Proportion")
data.field <- data.filter %>%
mutate(Social = ifelse(str_detect(Field, "Social Psychology"), 1, 0))%>%
mutate(Moral_Psychology = ifelse(str_detect(Field, "Moral Psychology"), 1, 0))%>%
mutate(Wisdom = ifelse(str_detect(Field, "Wisdom"), 1, 0))%>%
mutate(Clinical = ifelse(str_detect(Field, "Clinical"), 1, 0))%>%
mutate(Personality  = ifelse(str_detect(Field, "Personality"), 1, 0))%>%
mutate(Education = ifelse(str_detect(Field, "Education"), 1, 0))%>%
mutate(Developmental = ifelse(str_detect(Field, "Developmental"), 1, 0))%>%
mutate(CogSci = ifelse(str_detect(Field, "Cognitive Science"), 1, 0))%>%
mutate(Cognitive = ifelse(str_detect(Field, "Cognitive Psychology"), 1, 0))%>%
mutate(Quantitative = ifelse(str_detect(Field, "Quantitative Psychology"), 1, 0))%>%
mutate(Evolutionary = ifelse(str_detect(Field, "Evolutionary Psychology"), 1, 0))%>%
mutate(Moral_philosophy = ifelse(str_detect(Field, "Moral philosophy"), 1, 0))%>%
mutate(Evolutionary = ifelse(str_detect(Field, "Evolutionary Psychology"), 1, 0))
data.field.long<-data.field %>% pivot_longer(cols = Social:Evolutionary,names_to="Field",values_to="Proportion")
data.field <- data.filter %>%
mutate(Social = ifelse(str_detect(Field, "Social Psychology"), 1, 0))%>%
mutate(Moral_Psychology = ifelse(str_detect(Field, "Moral Psychology"), 1, 0))%>%
mutate(Wisdom = ifelse(str_detect(Field, "Wisdom"), 1, 0))%>%
mutate(Clinical = ifelse(str_detect(Field, "Clinical"), 1, 0))%>%
mutate(Personality  = ifelse(str_detect(Field, "Personality"), 1, 0))%>%
mutate(Education = ifelse(str_detect(Field, "Education"), 1, 0))%>%
mutate(Developmental = ifelse(str_detect(Field, "Developmental"), 1, 0))%>%
mutate(CogSci = ifelse(str_detect(Field, "Cognitive Science"), 1, 0))%>%
mutate(Cognitive = ifelse(str_detect(Field, "Cognitive Psychology"), 1, 0))%>%
mutate(Quantitative = ifelse(str_detect(Field, "Quantitative Psychology"), 1, 0))%>%
mutate(Evolutionary = ifelse(str_detect(Field, "Evolutionary Psychology"), 1, 0))%>%
mutate(Moral_philosophy = ifelse(str_detect(Field, "Moral philosophy"), 1, 0)))
data.field <- data.filter %>%
mutate(Social = ifelse(str_detect(Field, "Social Psychology"), 1, 0))%>%
mutate(Moral_Psychology = ifelse(str_detect(Field, "Moral Psychology"), 1, 0))%>%
mutate(Wisdom = ifelse(str_detect(Field, "Wisdom"), 1, 0))%>%
mutate(Clinical = ifelse(str_detect(Field, "Clinical"), 1, 0))%>%
mutate(Personality  = ifelse(str_detect(Field, "Personality"), 1, 0))%>%
mutate(Education = ifelse(str_detect(Field, "Education"), 1, 0))%>%
mutate(Developmental = ifelse(str_detect(Field, "Developmental"), 1, 0))%>%
mutate(CogSci = ifelse(str_detect(Field, "Cognitive Science"), 1, 0))%>%
mutate(Cognitive = ifelse(str_detect(Field, "Cognitive Psychology"), 1, 0))%>%
mutate(Quantitative = ifelse(str_detect(Field, "Quantitative Psychology"), 1, 0))%>%
mutate(Evolutionary = ifelse(str_detect(Field, "Evolutionary Psychology"), 1, 0))%>%
mutate(Moral_philosophy = ifelse(str_detect(Field, "Moral philosophy"), 1, 0))
data.field.long<-data.field %>% pivot_longer(cols = Social:Evolutionary,names_to="Field",values_to="Proportion")
names(data.field)
data.field.long<-data.field %>% pivot_longer(cols = Social:Moral_philosophy,names_to="Field",values_to="Proportion")
data.field.long<-data.field %>% pivot_longer(cols = Social:Moral_philosophy,names_to="Fields",values_to="Proportion")
Field.Summary<-data.field.long %>%
group_by(Fields) %>%
summarise(Prop = mean(Proportion)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Fields, Percent)
Field.Summary
data.field.long
View(data.field.long)
table(data.filter$Social)
table(data.field$Social)
data.field
data.field.long<-data.field %>% pivot_longer(cols = Social:Moral_philosophy,names_to="Fields",values_to="Proportion")
Field.Summary<-data.field.long %>%
group_by(Fields) %>%
summarise(Prop = mean(Proportion)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Fields, Percent)
Field.Summary
#country
data.filter%>%
group_by(country) %>%
summarise(tally = n()) %>%
arrange(desc(tally))
ggplot(data.filter, aes(x = country)) + geom_histogram(stat="count")+coord_flip()
#position / level
data.filter%>%
group_by(position) %>%
summarise(tally = n()) %>%
arrange(desc(tally))
ggplot(data.filter, aes(x = position)) + geom_histogram(stat="count")+coord_flip()
table(data.filter$Position)
#field
data.filter%>%
group_by(Field) %>%
summarise(tally = n()) %>%
arrange(desc(tally))
# a bit complicated - multiple fields. Need to review and create categories for wisdom, social, moral, personality, clinical, cognitive
data.field <- data.filter %>%
mutate(Social = ifelse(str_detect(Field, "Social Psychology"), 1, 0))%>%
mutate(Moral_Psychology = ifelse(str_detect(Field, "Moral Psychology"), 1, 0))%>%
mutate(Wisdom = ifelse(str_detect(Field, "Wisdom"), 1, 0))%>%
mutate(Clinical = ifelse(str_detect(Field, "Clinical"), 1, 0))%>%
mutate(Personality  = ifelse(str_detect(Field, "Personality"), 1, 0))%>%
mutate(Education = ifelse(str_detect(Field, "Education"), 1, 0))%>%
mutate(Developmental = ifelse(str_detect(Field, "Developmental"), 1, 0))%>%
mutate(CogSci = ifelse(str_detect(Field, "Cognitive Science"), 1, 0))%>%
mutate(Cognitive = ifelse(str_detect(Field, "Cognitive Psychology"), 1, 0))%>%
mutate(Quantitative = ifelse(str_detect(Field, "Quantitative Psychology"), 1, 0))%>%
mutate(Evolutionary = ifelse(str_detect(Field, "Evolutionary Psychology"), 1, 0))%>%
mutate(Moral_philosophy = ifelse(str_detect(Field, "Moral philosophy"), 1, 0))
table(data.field$Social)
prop.table(table(data.field$Social))
prop.table(table(data.field$Moral_Psychology))
prop.table(table(data.field$Wisdom))
prop.table(table(data.field$Clinical))
prop.table(table(data.field$Personality))
prop.table(table(data.field$Education))
prop.table(table(data.field$Developmental))
prop.table(table(data.field$CogSci))
prop.table(table(data.field$Cognitive))
prop.table(table(data.field$Quantitative))
prop.table(table(data.field$Evolutionary))
prop.table(table(data.field$Moral_philosophy))
data.field <- data.filter %>%
mutate(Social = ifelse(str_detect(Field, "Social Psychology"), 1, 0))%>%
mutate(Moral_Psychology = ifelse(str_detect(Field, "Moral Psychology"), 1, 0))%>%
mutate(Wisdom = ifelse(str_detect(Field, "Wisdom"), 1, 0))%>%
mutate(Clinical = ifelse(str_detect(Field, "Clinical"), 1, 0))%>%
mutate(Personality  = ifelse(str_detect(Field, "Personality"), 1, 0))%>%
mutate(Education = ifelse(str_detect(Field, "Education"), 1, 0))%>%
mutate(Developmental = ifelse(str_detect(Field, "Developmental"), 1, 0))%>%
mutate(CogSci = ifelse(str_detect(Field, "Cognitive Science"), 1, 0))%>%
mutate(Cognitive = ifelse(str_detect(Field, "Cognitive Psychology"), 1, 0))%>%
mutate(Quantitative = ifelse(str_detect(Field, "Quantitative Psychology"), 1, 0))%>%
mutate(Evolutionary = ifelse(str_detect(Field, "Evolutionary Psychology"), 1, 0))%>%
mutate(Virtue = ifelse(str_detect(Field, "Virtue"), 1, 0))%>%
mutate(Moral_philosophy = ifelse(str_detect(Field, "Moral philosophy"), 1, 0))
prop.table(table(data.field$Virtue))

ggplot(aes(x = Category, y = prob, colour = Group.F, fill=Group.F))+
geom_pointrange(aes(ymin=asymp.LCL, ymax=asymp.UCL), position=pd)+  theme_minimal() +
theme(legend.position="top") +scale_color_d3()+scale_fill_d3()+
labs(colour = "",fill="", x="",y="Proportion +/-95%CI")
emmeans(glmer.morals,pairwise ~Group.F|Category,  trans = "response")
names(WisMor)
data.filter<-data %>%
filter(!is.na(morality_wis_analogy) |
!is.na(moral_wis_comments) |
!is.na(wis_psych_char) |
!is.na(model_agreement) |
!is.na(model_disagree) |
!is.na(wisdom_culture)|
!is.na(comments)) %>%
rename(Position = position2, Field = field)
WisMor <- data.filter %>%
mutate(M2W_Relevant = ifelse(str_detect(moral_to_wis_agree, "relevant"), 1, 0))%>%
mutate(M2W_Precursor = ifelse(str_detect(moral_to_wis_agree, "precursor"), 1, 0))%>%
mutate(M2W_Necessary = ifelse(str_detect(moral_to_wis_agree, "necessary"), 1, 0))%>%
mutate(M2W_Sufficient = ifelse(str_detect(moral_to_wis_agree, "sufficient"), 1,0))%>%
mutate(M2W_Unrelated = ifelse(is.na(moral_to_wis_agree), 1, 0))%>%
mutate(W2M_Relevant = ifelse(str_detect(wis_to_moral_agree, "relevant"), 1, 0))%>%
mutate(W2M_Precursor = ifelse(str_detect(wis_to_moral_agree, "precursor"), 1, 0))%>%
mutate(W2M_Necessary = ifelse(str_detect(wis_to_moral_agree, "necessary"), 1, 0))%>%
mutate(W2M_Sufficient = ifelse(str_detect(wis_to_moral_agree, "sufficient"), 1, 0))%>%
mutate(W2M_Unrelated = ifelse(is.na(wis_to_moral_agree), 1, 0)) %>%
mutate(M2W_Relevant = coalesce(M2W_Relevant, 0),
M2W_Precursor = coalesce(M2W_Precursor, 0),
M2W_Necessary = coalesce(M2W_Necessary, 0),
M2W_Sufficient = coalesce(M2W_Sufficient, 0),
W2M_Relevant = coalesce(W2M_Relevant, 0),
W2M_Precursor= coalesce(W2M_Precursor, 0),
W2M_Necessary = coalesce(W2M_Necessary, 0),
W2M_Sufficient = coalesce(W2M_Sufficient, 0))
#how many responses?
length(WisMor$M2W_Necessary)
WisMor.long<-WisMor %>% pivot_longer(M2W_Relevant:W2M_Sufficient,names_sep="_",names_to=c("Group","Category"),values_to="Proportion")
WisMor.long$Group.F[WisMor.long$Group=="M2W"]<-"Morality to Wisdom"
WisMor.long$Group.F[WisMor.long$Group=="W2M"]<-"Wisdom to Morality"
names(WisMor)
Moral.open <- WisMor %>%
filter(!is.na(FRMW_FINAL)) %>%
mutate(Fixed=ifelse(FM_FINAL==1,1,0), Malleable=ifelse(FM_FINAL==2,1,0)) %>%
select(CountryCode,Progress, Duration,position2,ResponseId,field,prior_research:education,moral_wis_comments,morality_wis_analogy,wis_psych_char,
FRMW_FINAL,  FRWM_FINAL, FRJF_FINAL,TRMW_FINAL,TRWM_FINAL,TRHOC_FINAL,PR_FINAL,DR_FINAL,PROCESS.MECH_FINAL,PROCESS.LIFE_FINAL,CONSTRUCT_FINAL,Fixed,Malleable, Social,Moral_Psychology,Moral_philosophy,Education,CogSci, Developmental) %>%
rename(Position = position2, Field = field)
WisMor$Position
WisMor$Field
Moral.open <- WisMor %>%
filter(!is.na(FRMW_FINAL)) %>%
mutate(Fixed=ifelse(FM_FINAL==1,1,0), Malleable=ifelse(FM_FINAL==2,1,0)) %>%
select(CountryCode,Progress, Duration,position2,ResponseId,field,prior_research:education,moral_wis_comments,morality_wis_analogy,wis_psych_char,
FRMW_FINAL,  FRWM_FINAL, FRJF_FINAL,TRMW_FINAL,TRWM_FINAL,TRHOC_FINAL,PR_FINAL,DR_FINAL,PROCESS.MECH_FINAL,PROCESS.LIFE_FINAL,CONSTRUCT_FINAL,Fixed,Malleable, Social,Moral_Psychology,Moral_philosophy,Education,CogSci, Developmental)
Moral.open <- WisMor %>%
filter(!is.na(FRMW_FINAL)) %>%
mutate(Fixed=ifelse(FM_FINAL==1,1,0), Malleable=ifelse(FM_FINAL==2,1,0)) %>%
select(CountryCode,Progress, Duration,Position,ResponseId,Field,prior_research:education,moral_wis_comments,morality_wis_analogy,wis_psych_char,
FRMW_FINAL,  FRWM_FINAL, FRJF_FINAL,TRMW_FINAL,TRWM_FINAL,TRHOC_FINAL,PR_FINAL,DR_FINAL,PROCESS.MECH_FINAL,PROCESS.LIFE_FINAL,CONSTRUCT_FINAL,Fixed,Malleable, Social,Moral_Psychology,Moral_philosophy,Education,CogSci, Developmental)
pd <- position_dodge(0.7) # move them .07 to the left and right
labels<-c(
FRMW_FINAL = "Functional:\nMorals=>Wisdom",
FRWM_FINAL = "Functional:\nWisdom=>Morals",
FRJF_FINAL = "Functional:\nJoint Function",
TRMW_FINAL = "Taxonomic:\nMorals part of Wisdom",
TRWM_FINAL = "Taxonomic:\nWisdom part of Morals",
TRHOC_FINAL = "Taxonomic:\nHigher order cat",
PR_FINAL ="Probabilistic",
DR_FINAL = "Deterministic",
PROCESS.MECH_FINAL = "Theme:\nWisdom as Mechanism",
PROCESS.LIFE_FINAL = "Theme:\nLife Process",
CONSTRUCT_FINAL = "Theme:\nConstructivism")
#how many responses?
length(Moral.open$FRMW_FINAL)
Moral.open.long<-Moral.open %>% pivot_longer(FRMW_FINAL:Malleable,names_to="Category",values_to="Score")
Moral.open.Summary<-Moral.open.long %>%
group_by(Category) %>%
summarise(Prop = mean(Score, na.rm=T)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Percent)
Moral.open.Summary %>% arrange(Percent) %>%
mutate(Category=factor(Category, levels=Category)) %>%
ggplot(aes(x=Category, y=Percent)) +
geom_point(col="tomato2", size=3) +   # Draw points
geom_segment(aes(x=Category,
xend=Category,
y=min(Percent),
yend=max(Percent)),
linetype="dashed",
size=0.1) + theme_minimal()+  # Draw dashed lines
coord_flip()+scale_color_aaas()+scale_x_discrete(labels=labels, name="")
lmer.open.morals<-glmer(Score~Category+ (1|ResponseId),data =Moral.open.long, family=binomial(link="logit") )
morals.open.estimates %>%
ggplot(aes(x = Category, y = prob, colour = Category, fill=Category))+
geom_pointrange(aes(ymin=asymp.LCL, ymax=asymp.UCL), position=pd)+  theme_minimal() +
theme(legend.position="none") +scale_color_d3()+scale_fill_d3()+
labs(colour = "",fill="", x="",y="Proportion +/-95%CI") +scale_x_discrete(labels=labels, name="")
lmer.open.morals<-glmer(Score~Category+ (1|ResponseId),data =Moral.open.long, family=binomial(link="logit") )
Anova(lmer.open.morals,type=3)
emmeans(lmer.open.morals,pairwise ~Category,  trans = "response")
morals.open.estimates<-as.data.frame((emmeans(lmer.open.morals,pairwise ~Category,  trans = "response"))$emmeans)
pd <- position_dodge(0.7) # move them .07 to the left and right
morals.open.estimates %>%
ggplot(aes(x = Category, y = prob, colour = Category, fill=Category))+
geom_pointrange(aes(ymin=asymp.LCL, ymax=asymp.UCL), position=pd)+  theme_minimal() +
theme(legend.position="none") +scale_color_d3()+scale_fill_d3()+
labs(colour = "",fill="", x="",y="Proportion +/-95%CI") +scale_x_discrete(labels=labels, name="")
names(Moral.open.long)
names(WisMor)
Moral.open <- WisMor %>%
filter(!is.na(FRMW_FINAL)) %>%
mutate(Fixed=ifelse(FM_FINAL==1,1,0), Malleable=ifelse(FM_FINAL==2,1,0)) %>%
select(CountryCode,Progress, Duration,Position,ResponseId,Field,prior_research:education,moral_wis_comments,morality_wis_analogy,wis_psych_char,
FRMW_FINAL,  FRWM_FINAL, FRJF_FINAL,TRMW_FINAL,TRWM_FINAL,TRHOC_FINAL,PR_FINAL,DR_FINAL,PROCESS.MECH_FINAL,PROCESS.LIFE_FINAL,CONSTRUCT_FINAL,Fixed,Malleable, Social,Moral_Psychology,Moral_philosophy,Education,CogSci, Developmental, M2W_Relevant:W2M_Unrelated)
pd <- position_dodge(0.7) # move them .07 to the left and right
labels<-c(
FRMW_FINAL = "Functional:\nMorals=>Wisdom",
FRWM_FINAL = "Functional:\nWisdom=>Morals",
FRJF_FINAL = "Functional:\nJoint Function",
TRMW_FINAL = "Taxonomic:\nMorals part of Wisdom",
TRWM_FINAL = "Taxonomic:\nWisdom part of Morals",
TRHOC_FINAL = "Taxonomic:\nHigher order cat",
PR_FINAL ="Probabilistic",
DR_FINAL = "Deterministic",
PROCESS.MECH_FINAL = "Theme:\nWisdom as Mechanism",
PROCESS.LIFE_FINAL = "Theme:\nLife Process",
CONSTRUCT_FINAL = "Theme:\nConstructivism")
#how many responses?
length(Moral.open$FRMW_FINAL)
Moral.open.long<-Moral.open %>% pivot_longer(FRMW_FINAL:Malleable,names_to="Category",values_to="Score")
names(Moral.open.long)
lmer.open.morals.ness<-glmer(Score~Category*M2W_Necessary+ (1|ResponseId),data =Moral.open.long, family=binomial(link="logit") )
Anova(lmer.open.morals.ness,type=3)
#Importing Packages, Data----
rm(list=ls())
library(tidyverse)
library(tm)
library(stringr)
library(tidytext)
library(kableExtra)
library(ggplot2)
library(kableExtra)
library(ggsci)
library(vcd)
library(lme4)
library(emmeans)
library(jtools)
library(sjPlot)
library(car)
setwd("~/GitHub/wisdom-summit-2021")
raw <- read.csv('Wisdom_Summit_Sept_21_2021.csv')
culture<-read.csv('culture.csv')
morality<-read.csv('morality.csv')
total<-raw %>% left_join(culture) %>% left_join(morality)
#Adding Variables ----
total <- total %>% filter(!grepl("progress",Progress, ignore.case = TRUE)) %>%
rename(Duration=Duration..in.seconds.)
total$Duration <- as.numeric(total$Duration)
total <- total %>%
mutate(filter = ifelse(str_detect(wisdom_culture, "useless|1"), 1, 0)) %>%
mutate(filter = ifelse(!is.na(country) & str_detect(country, "TEST"), 1, filter)) %>%
mutate(filter = ifelse(!is.na(country) & str_detect(country, "test"), 1, filter)) %>%
mutate(filter = ifelse(Duration < 30, 1, filter)) #if they spent less than 30 seconds, remove them
total$filter <- as.factor(total$filter)
# summary(raw$filter)
data <- total %>% filter(filter==0)
data <- data %>%
mutate(position2 = ifelse(position == "Other" &
str_detect(position_8_TEXT,"Lecturer|Emeritus|senior lecturer|On sabbatical"),
"Professor",position))%>%
mutate(position2 = ifelse(position == "Other" &
str_detect(position_8_TEXT, "PhD scholar|RA|scientist|psychologist|Associate"),
"Graduate Student",position2))
# data%>%filter(position == "Other") %>% select(position,position_8_TEXT, education, position2)
USlist <- c("US", "us", "Usa", "United States of America","united States", "United States", "The United States of America")
UKlist <- c("UK","united kingdom", "United Kingdom", "England")
data$country <- data$country %>% str_trim()
data <- data %>%
mutate(country = ifelse(country %in% USlist,"USA", country))%>%
mutate(country = ifelse(country %in% UKlist, "UK", country))%>%
mutate(country = ifelse(country =="BG", "Bulgaria", country)) %>%
mutate(country = ifelse(country =="CHINA", "China", country)) %>%
mutate(country = ifelse(country =="canada", "Canada", country)) %>%
mutate(country = ifelse(country == "HK", "China", country)) %>%
mutate(country = ifelse(country == "Hong Kong", "China", country)) %>%
mutate(country = ifelse(country == "Russian Federation", "Russia", country)) %>%
mutate(country = ifelse(country == "Nederland", "Netherlands", country)) %>%
mutate(country = ifelse(country == "philippines", "Philippines", country)) %>%
mutate(country = ifelse(country == "Hong Kong S.A.R. / China", "China", country)) %>%
mutate(country = ifelse(country == "Viet Nam", "Vietnam", country)) %>%
mutate(country = ifelse(country == "turkey", "Turkey", country))
data <- data %>%
mutate(position2= ifelse(str_detect(position2,"Professor"), "Professor", "Not a Professor"))
data <- data %>%
mutate(CountryCode= ifelse(str_detect(country,"USA|Canada"), "USA & Canada", "Others"))
cols <- c("country","CountryCode","position","position2")
data[,cols] <- lapply(data[,cols],as.factor)
#Adding Variables ----
total <- total %>% filter(!grepl("progress",Progress, ignore.case = TRUE)) %>%
rename(Duration=Duration..in.seconds.)
#Subset Data & No Of Answers ----
data <- data %>%
mutate_all(na_if,"")
data <- data %>%
mutate(Social = ifelse(str_detect(field, "Social Psychology"), 1, 0))%>%
mutate(Moral_Psychology = ifelse(str_detect(field, "Moral Psychology"), 1, 0))%>%
mutate(Wisdom = ifelse(str_detect(field, "Wisdom"), 1, 0))%>%
mutate(Clinical = ifelse(str_detect(field, "Clinical"), 1, 0))%>%
mutate(Personality  = ifelse(str_detect(field, "Personality"), 1, 0))%>%
mutate(Education = ifelse(str_detect(field, "Education"), 1, 0))%>%
mutate(Developmental = ifelse(str_detect(field, "Developmental"), 1, 0))%>%
mutate(CogSci = ifelse(str_detect(field, "Cognitive Science"), 1, 0))%>%
mutate(Cognitive = ifelse(str_detect(field, "Cognitive Psychology"), 1, 0))%>%
mutate(Quantitative = ifelse(str_detect(field, "Quantitative Psychology"), 1, 0))%>%
mutate(Evolutionary = ifelse(str_detect(field, "Evolutionary Psychology"), 1, 0))%>%
mutate(Moral_philosophy = ifelse(str_detect(field, "Moral philosophy"), 1, ifelse(str_detect(field, "Virtue"), 1, 0)))%>%
mutate(Virtue = ifelse(str_detect(field, "Virtue"), 1, 0))
data.filter<-data %>%
filter(!is.na(morality_wis_analogy) |
!is.na(moral_wis_comments) |
!is.na(wis_psych_char) |
!is.na(model_agreement) |
!is.na(model_disagree) |
!is.na(wisdom_culture)|
!is.na(comments)) %>%
rename(Position = position2, Field = field)
library(forcats)
#country
data.filter%>%
group_by(country) %>%
summarise(tally = n()) %>%
arrange(desc(tally)) %>%
mutate(country = fct_reorder(country, tally)) %>%
ggplot(aes(x=country, y=tally)) +
geom_bar(stat="identity", alpha=.6, width=.4) +
coord_flip() +labs(x="",y="Count") +theme_minimal()
data.filter %>%
ggplot(aes(x = country)) + geom_histogram(stat="count")+coord_flip()
#position / level
data.filter%>%
group_by(position) %>%
summarise(tally = n()) %>%
arrange(desc(tally))  %>%     mutate(position = fct_reorder(position, tally)) %>%
ggplot(aes(x=position, y=tally)) +
geom_bar(stat="identity", alpha=.6, width=.4) +
coord_flip() +labs(x="",y="Count") +theme_minimal()
ggplot(data.filter, aes(x = position)) + geom_histogram(stat="count")+coord_flip()
table(data.filter$Position)
#field
data.filter%>%
group_by(Field) %>%
summarise(tally = n()) %>%
arrange(desc(tally))
# a bit complicated - multiple fields.
prop.table(table(data.filter$Social))
prop.table(table(data.filter$Moral_Psychology))
prop.table(table(data.filter$Wisdom))
prop.table(table(data.filter$Clinical))
prop.table(table(data.filter$Personality))
prop.table(table(data.filter$Education))
prop.table(table(data.filter$Developmental))
prop.table(table(data.filter$CogSci))
prop.table(table(data.filter$Cognitive))
prop.table(table(data.filter$Quantitative))
prop.table(table(data.filter$Evolutionary))
prop.table(table(data.filter$Moral_philosophy))
prop.table(table(data.filter$Virtue))
WisMor <- data.filter %>%
mutate(M2W_Relevant = ifelse(str_detect(moral_to_wis_agree, "relevant"), 1, 0))%>%
mutate(M2W_Precursor = ifelse(str_detect(moral_to_wis_agree, "precursor"), 1, 0))%>%
mutate(M2W_Necessary = ifelse(str_detect(moral_to_wis_agree, "necessary"), 1, 0))%>%
mutate(M2W_Sufficient = ifelse(str_detect(moral_to_wis_agree, "sufficient"), 1,0))%>%
mutate(M2W_Unrelated = ifelse(is.na(moral_to_wis_agree), 1, 0))%>%
mutate(W2M_Relevant = ifelse(str_detect(wis_to_moral_agree, "relevant"), 1, 0))%>%
mutate(W2M_Precursor = ifelse(str_detect(wis_to_moral_agree, "precursor"), 1, 0))%>%
mutate(W2M_Necessary = ifelse(str_detect(wis_to_moral_agree, "necessary"), 1, 0))%>%
mutate(W2M_Sufficient = ifelse(str_detect(wis_to_moral_agree, "sufficient"), 1, 0))%>%
mutate(W2M_Unrelated = ifelse(is.na(wis_to_moral_agree), 1, 0)) %>%
mutate(M2W_Relevant = coalesce(M2W_Relevant, 0),
M2W_Precursor = coalesce(M2W_Precursor, 0),
M2W_Necessary = coalesce(M2W_Necessary, 0),
M2W_Sufficient = coalesce(M2W_Sufficient, 0),
W2M_Relevant = coalesce(W2M_Relevant, 0),
W2M_Precursor= coalesce(W2M_Precursor, 0),
W2M_Necessary = coalesce(W2M_Necessary, 0),
W2M_Sufficient = coalesce(W2M_Sufficient, 0))
#how many responses?
length(WisMor$M2W_Necessary)
WisMor.long<-WisMor %>% pivot_longer(M2W_Relevant:W2M_Sufficient,names_sep="_",names_to=c("Group","Category"),values_to="Proportion")
WisMor.long$Group.F[WisMor.long$Group=="M2W"]<-"Morality to Wisdom"
WisMor.long$Group.F[WisMor.long$Group=="W2M"]<-"Wisdom to Morality"
Wis.Mor.Summary<-WisMor.long %>%
group_by(Group.F, Category) %>%
summarise(Prop = mean(Proportion)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Group.F, Percent)
morals <- Wis.Mor.Summary %>%
# 1. Remove grouping
ungroup() %>%
# 2. Arrange by
#   i.  facet group
#   ii. bar height
arrange(Group.F, Percent) %>%
# 3. Add order column of row numbers
mutate(order = row_number())
#lollipop chart
morals %>% ggplot(aes(x=order, y=Percent, color=Group.F)) +
geom_point(size=3) +
geom_segment(aes(x=order,
xend=order,
y=0,
yend=Percent)) +facet_wrap(vars(Group.F), scales = "free")+
scale_x_continuous(   # Add categories to axis
breaks = morals$order,
labels = morals$Category)+theme_minimal(base_size = 14) +geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="none")+
scale_color_aaas()+ labs(colour = "Group",x="",y="% of the Sample")
xtabs(Proportion~Group.F+Category,WisMor.long)
plot(xtabs(Proportion~Category+Group.F,WisMor.long))
assocstats(xtabs(Proportion~Group.F+Category,WisMor.long))
Wis.Mor.Summary.position<-WisMor.long %>%
group_by(Position,Group.F, Category) %>%
summarise(Prop = mean(Proportion)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Position,Group.F, Percent)
Wis.Mor.Summary.position<-WisMor.long %>%
group_by(Position,Group.F, Category) %>%
summarise(Prop = mean(Proportion)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Position,Group.F, Percent)
Wis.Mor.Summary.position
plot(xtabs(Proportion~Position+Group.F+Category,WisMor.long))
assocstats(xtabs(Proportion~Group.F+Category+Position,WisMor.long))
ggplot(Wis.Mor.Summary.position, aes(x=Category, y=Percent, color=Group.F)) +
geom_point(size=3) +
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(Position))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))+geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="top")+
scale_color_npg()+ labs(colour = "Group",x="",y="% of the Sample")
ggplot(Wis.Mor.Summary.position, aes(x=Category, y=Percent, color=Group.F)) +
geom_point(size=3) +
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(Position))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))+geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="top")+
scale_color_npg()+ labs(colour = "Group",x="",y="% of the Sample")
ggplot(Wis.Mor.Summary.position, aes(x=Category, y=Percent, color=Group.F)) +
geom_point(size=3) +geom_jitter()+
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(Position))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))+geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="top")+
scale_color_npg()+ labs(colour = "Group",x="",y="% of the Sample")
ggplot(Wis.Mor.Summary.position, aes(x=Category, y=Percent, color=Group.F)) +
geom_point(size=3) +geom_jitter()+
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(Position))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))+geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="top")+
scale_color_npg()+ labs(colour = "Group",x="",y="% of the Sample")
ggplot(Wis.Mor.Summary.position, aes(x=Category, y=Percent, color=Group.F)) +
geom_point(size=3, alpha = 0.5) +geom_jitter()+
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(Position))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))+geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="top")+
scale_color_npg()+ labs(colour = "Group",x="",y="% of the Sample")
ggplot(Wis.Mor.Summary.position, aes(x=Category, y=Percent, color=Group.F)) +
geom_point(size=3, alpha = 0.5) +
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(Position))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))+geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="top")+
scale_color_npg()+ labs(colour = "Group",x="",y="% of the Sample")
ggplot(Wis.Mor.Summary.position, aes(x=Category, y=Percent, color=Group.F, shape=Group.F)) +
geom_point(size=3, alpha = 0.5) +
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(Position))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))+geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="top")+
scale_color_npg()+ labs(colour = "Group",x="",y="% of the Sample")
ggplot(Wis.Mor.Summary.position, aes(x=Category, y=Percent, color=Group.F, shape=Group.F)) +
geom_point(size=3, alpha = 0.5) +
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(Position))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))+geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="top")+
scale_color_npg()+ labs(colour = "Group",shape="Group",x="",y="% of the Sample")
Moral.open <- WisMor %>%
filter(!is.na(FRMW_FINAL)) %>%
mutate(Fixed=ifelse(FM_FINAL==1,1,0), Malleable=ifelse(FM_FINAL==2,1,0)) %>%
select(CountryCode,Progress, Duration,Position,ResponseId,Field,prior_research:education,moral_wis_comments,morality_wis_analogy,wis_psych_char,
FRMW_FINAL,  FRWM_FINAL, FRJF_FINAL,TRMW_FINAL,TRWM_FINAL,TRHOC_FINAL,PR_FINAL,DR_FINAL,PROCESS.MECH_FINAL,PROCESS.LIFE_FINAL,CONSTRUCT_FINAL,Fixed,Malleable, Social,Moral_Psychology,Moral_philosophy,Education,CogSci, Developmental, M2W_Relevant:W2M_Unrelated)
pd <- position_dodge(0.7) # move them .07 to the left and right
labels<-c(
FRMW_FINAL = "Functional:\nMorals=>Wisdom",
FRWM_FINAL = "Functional:\nWisdom=>Morals",
FRJF_FINAL = "Functional:\nJoint Function",
TRMW_FINAL = "Taxonomic:\nMorals part of Wisdom",
TRWM_FINAL = "Taxonomic:\nWisdom part of Morals",
TRHOC_FINAL = "Taxonomic:\nHigher order cat",
PR_FINAL ="Probabilistic",
DR_FINAL = "Deterministic",
PROCESS.MECH_FINAL = "Theme:\nWisdom as Mechanism",
PROCESS.LIFE_FINAL = "Theme:\nLife Process",
CONSTRUCT_FINAL = "Theme:\nConstructivism")
labels.N<-c(
FRMW_FINAL = "1. Functional:\nMorals=>Wisdom",
FRWM_FINAL = "2. Functional:\nWisdom=>Morals",
FRJF_FINAL = "3. Functional:\nJoint Function",
TRMW_FINAL = "4. Taxonomic:\nMorals part of Wisdom",
TRWM_FINAL = "5. Taxonomic:\nWisdom part of Morals",
TRHOC_FINAL = "6. Taxonomic:\nHigher order cat",
PR_FINAL ="7. Probabilistic",
DR_FINAL = "8. Deterministic",
PROCESS.MECH_FINAL = "9. Theme:\nWisdom as Mechanism",
PROCESS.LIFE_FINAL = "10. Theme:\nLife Process",
CONSTRUCT_FINAL = "11. Theme:\nConstructivism")
#how many responses?
length(Moral.open$FRMW_FINAL)
Moral.open.long<-Moral.open %>% pivot_longer(FRMW_FINAL:Malleable,names_to="Category",values_to="Score")
Moral.open.Summary<-Moral.open.long %>%
group_by(Category) %>%
summarise(Prop = mean(Score, na.rm=T)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Percent)
Moral.open.Summary %>% arrange(Percent) %>%
mutate(Category=factor(Category, levels=Category)) %>%
ggplot(aes(x=Category, y=Percent)) +
geom_point(col="tomato2", size=3) +   # Draw points
geom_segment(aes(x=Category,
xend=Category,
y=min(Percent),
yend=max(Percent)),
linetype="dashed",
size=0.1) + theme_minimal()+  # Draw dashed lines
coord_flip()+scale_color_aaas()+scale_x_discrete(labels=labels, name="")
lmer.open.morals<-glmer(Score~Category+ (1|ResponseId),data =Moral.open.long, family=binomial(link="logit") )
Anova(lmer.open.morals,type=3)
emmeans(lmer.open.morals,pairwise ~Category,  trans = "response")
morals.open.estimates<-as.data.frame((emmeans(lmer.open.morals,pairwise ~Category,  trans = "response"))$emmeans)
pd <- position_dodge(0.7) # move them .07 to the left and right
morals.open.estimates %>%
ggplot(aes(x = Category, y = prob, colour = Category, fill=Category))+
geom_pointrange(aes(ymin=asymp.LCL, ymax=asymp.UCL), position=pd)+  theme_minimal() +
theme(legend.position="none") +scale_color_d3()+scale_fill_d3()+
labs(colour = "",fill="", x="",y="Proportion +/-95%CI") +scale_x_discrete(labels=labels, name="")
r
#personality
#social
Moral.open.Summary.Personality<-Moral.open.long %>%
filter(!is.na(Personality))%>%
group_by(Social,Category) %>%
summarise(Prop = mean(Score, na.rm=T)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Personality,Percent) %>%
mutate(Soc.factor=ifelse(Personality==1,"Personality","Not Personality"))
names(Moral.open.long)
Moral.open <- WisMor %>%
filter(!is.na(FRMW_FINAL)) %>%
mutate(Fixed=ifelse(FM_FINAL==1,1,0), Malleable=ifelse(FM_FINAL==2,1,0)) %>%
select(CountryCode,Progress, Duration,Position,ResponseId,Field,prior_research:education,moral_wis_comments,morality_wis_analogy,wis_psych_char,
FRMW_FINAL,  FRWM_FINAL, FRJF_FINAL,TRMW_FINAL,TRWM_FINAL,TRHOC_FINAL,PR_FINAL,DR_FINAL,PROCESS.MECH_FINAL,PROCESS.LIFE_FINAL,CONSTRUCT_FINAL,Fixed,Malleable, Social,Personality,Moral_Psychology,Moral_philosophy,Education,CogSci, Developmental, M2W_Relevant:W2M_Unrelated)
Moral.open.Summary.Mness<-Moral.open.long %>%
group_by(Category,M2W_Necessary) %>%
summarise(Prop = mean(Score, na.rm=T)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Percent)
#personality
#social
Moral.open.Summary.Personality<-Moral.open.long %>%
filter(!is.na(Personality))%>%
group_by(Social,Category) %>%
summarise(Prop = mean(Score, na.rm=T)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Personality,Percent) %>%
mutate(Soc.factor=ifelse(Personality==1,"Personality","Not Personality"))
names(Moral.open.long)
Moral.open.long<-Moral.open %>% pivot_longer(FRMW_FINAL:Malleable,names_to="Category",values_to="Score")
#personality
#social
Moral.open.Summary.Personality<-Moral.open.long %>%
filter(!is.na(Personality))%>%
group_by(Social,Category) %>%
summarise(Prop = mean(Score, na.rm=T)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Personality,Percent) %>%
mutate(Soc.factor=ifelse(Personality==1,"Personality","Not Personality"))
names(Moral.open.long)
#personality
#social
Moral.open.Summary.Personality<-Moral.open.long %>%
filter(!is.na(Personality))%>%
group_by(Social,Category) %>%
summarise(Prop = mean(Score, na.rm=T)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Personality,Percent) %>%
mutate(Soc.factor=ifelse(Personality==1,"Personality","Not Personality"))
Moral.open.long$Personality
#personality
#social
Moral.open.Summary.Personality<-Moral.open.long %>%
filter(!is.na(Personality))%>%
group_by(Personality,Category) %>%
summarise(Prop = mean(Score, na.rm=T)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Personality,Percent) %>%
mutate(Pers.factor=ifelse(Personality==1,"Personality","Not Personality"))
ggplot(Moral.open.Summary.Personality, aes(x=Category, y=Percent, color=Pers.factor)) +
geom_point(size=3) +
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) +
theme(axis.text.x = element_text(angle=65, vjust=0.6))+theme(legend.position="top")+
scale_color_aaas()+ labs(colour = "Group",x="",y="% of the Sample") +scale_x_discrete(labels=labels, name="")

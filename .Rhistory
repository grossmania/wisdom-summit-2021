morality<-read.csv('morality.csv')
total<-raw %>% left_join(culture) %>% left_join(morality)
#Adding Variables ----
total <- total %>% filter(!grepl("progress",Progress, ignore.case = TRUE)) %>%
rename(Duration=Duration..in.seconds.)
total$Duration <- as.numeric(raw$Duration)
total <- total %>%
mutate(filter = ifelse(str_detect(wisdom_culture, "useless|1"), 1, 0)) %>%
mutate(filter = ifelse(!is.na(country) & str_detect(country, "TEST"), 1, filter)) %>%
mutate(filter = ifelse(Duration < 45, 1, filter)) #if they spent less than 45 seconds, remove them
total$filter <- as.factor(total$filter)
# summary(raw$filter)
data <- total %>% filter(filter==0)
data <- data %>%
mutate(position2 = ifelse(position == "Other" &
str_detect(position_8_TEXT,"Lecturer|Emeritus|senior lecturer|On sabbatical"),
"Professor",position))%>%
mutate(position2 = ifelse(position == "Other" &
str_detect(position_8_TEXT, "PhD scholar|RA|scientist|psychologist|Associate"),
"Graduate Student",position2))
# data%>%filter(position == "Other") %>% select(position,position_8_TEXT, education, position2)
USlist <- c("US", "us", "Usa", "United States of America","united States", "United States", "The United States of America")
UKlist <- c("UK","united kingdom", "United Kingdom", "England")
data$country <- data$country %>% str_trim()
data <- data %>%
mutate(country = ifelse(country %in% USlist,"USA", country))%>%
mutate(country = ifelse(country %in% UKlist, "UK", country))%>%
mutate(country = ifelse(country =="BG", "Bulgaria", country)) %>%
mutate(country = ifelse(country =="CHINA", "China", country)) %>%
mutate(country = ifelse(country =="canada", "Canada", country)) %>%
mutate(country = ifelse(country == "HK", "Hong Kong", country)) %>%
mutate(country = ifelse(country == "Russian Federation", "Russia", country)) %>%
mutate(country = ifelse(country == "Viet Nam", "Vietnam", country)) %>%
mutate(country = ifelse(country == "turkey", "Turkey", country))
data <- data %>%
mutate(position2= ifelse(str_detect(position2,"Professor"), "Professor", "Not a Professor"))
data <- data %>%
mutate(CountryCode= ifelse(str_detect(country,"USA|Canada"), "USA & Canada", "Others"))
cols <- c("country","CountryCode","position","position2")
data[,cols] <- lapply(data[,cols],as.factor)
data <- data %>%
mutate_all(na_if,"")
WisMor <- data %>%
filter(!is.na(morality_wis_analogy) |
!is.na(wis_psych_char) |
!is.na(model_agreement) |
!is.na(model_disagree) |
!is.na(wisdom_culture)) %>%
select(CountryCode,Progress, Duration,position2,ResponseId,field,prior_research:education,
moral_to_wis_agree, wis_to_moral_agree, morality_wis_analogy,wis_psych_char,wisdomModelFamiliar) %>%
rename(Position = position2, Education = education, Field = field)
WisMor <- WisMor %>%
mutate(M2W_Relevant = ifelse(str_detect(moral_to_wis_agree, "relevant"), 1, 0))%>%
mutate(M2W_Precursor = ifelse(str_detect(moral_to_wis_agree, "precursor"), 1, 0))%>%
mutate(M2W_Necessary = ifelse(str_detect(moral_to_wis_agree, "necessary"), 1, 0))%>%
mutate(M2W_Sufficient = ifelse(str_detect(moral_to_wis_agree, "sufficient"), 1,0))%>%
mutate(M2W_Unrelated = ifelse(is.na(moral_to_wis_agree), 1, 0))%>%
mutate(W2M_Relevant = ifelse(str_detect(wis_to_moral_agree, "relevant"), 1, 0))%>%
mutate(W2M_Precursor = ifelse(str_detect(wis_to_moral_agree, "precursor"), 1, 0))%>%
mutate(W2M_Necessary = ifelse(str_detect(wis_to_moral_agree, "necessary"), 1, 0))%>%
mutate(W2M_Sufficient = ifelse(str_detect(wis_to_moral_agree, "sufficient"), 1, 0))%>%
mutate(W2M_Unrelated = ifelse(is.na(wis_to_moral_agree), 1, 0)) %>%
mutate(M2W_Relevant = coalesce(M2W_Relevant, 0),
M2W_Precursor = coalesce(M2W_Precursor, 0),
M2W_Necessary = coalesce(M2W_Necessary, 0),
M2W_Sufficient = coalesce(M2W_Sufficient, 0),
W2M_Relevant = coalesce(W2M_Relevant, 0),
W2M_Precursor= coalesce(W2M_Precursor, 0),
W2M_Necessary = coalesce(W2M_Necessary, 0),
W2M_Sufficient = coalesce(W2M_Sufficient, 0))
WisMor.long<-WisMor %>% pivot_longer(M2W_Relevant:W2M_Sufficient,names_sep="_",names_to=c("Group","Category"),values_to="Proportion")
WisMor.long$Group.F[WisMor.long$Group=="M2W"]<-"Morality to Wisdom"
WisMor.long$Group.F[WisMor.long$Group=="W2M"]<-"Wisdom to Morality"
View(WisMor.long)
WisMor.long %>%
summarise(Proportion, ~ mean(.x, na.rm = TRUE)))
WisMor.long %>%
summarise(Proportion, ~ mean(.x, na.rm = TRUE))
WisMor.long %>%
summarise(Proportion,. ~ mean(.x, na.rm = TRUE))
WisMor.long %>%
group_by(Group, Category) %>%
summarise(Proportion = mean())
WisMor.long %>%
group_by(Group, Category) %>%
summarise(Prop = mean(Proportion))
Wis.Mor.Summary<-WisMor.long %>%
group_by(Group.F, Category) %>%
summarise(Prop = mean(Proportion)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Group, Percent)
Wis.Mor.Summary<-WisMor.long %>%
group_by(Group.F, Category) %>%
summarise(Prop = mean(Proportion)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Group.F, Percent)
View(Wis.Mor.Summary)
xtabs(~Group.F+Category,WisMor.long)
morals <- Wis.Mor.Summary %>%
# 1. Remove grouping
ungroup() %>%
# 2. Arrange by
#   i.  facet group
#   ii. bar height
arrange(Group.F, Percent) %>%
# 3. Add order column of row numbers
mutate(order = row_number())
#lollipop chart
morals %>% ggplot(aes(x=order, y=Percent, color=Group.F)) +
geom_point(size=3) +
geom_segment(aes(x=order,
xend=order,
y=0,
yend=Percent)) +facet_wrap(vars(Group.F), scales = "free")+
scale_x_continuous(   # Add categories to axis
breaks = morals$order,
labels = morals$Category)+theme_minimal(base_size = 14) +geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="none")+
scale_color_aaas()+ labs(colour = "Group",x="",y="% of the Sample")
View(morals)
morals %>% ggplot(aes(x=order, y=Percent, color=Group.F)) +
geom_point(size=3) +
geom_segment(aes(x=order,
xend=order,
y=0,
yend=Percent)) +facet_wrap(vars(Group.F), scales = "free")+
scale_x_continuous(   # Add categories to axis
breaks = morals$order,
labels = morals$Category)+theme_minimal(base_size = 14) +geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="none")+
scale_color_aaas()+ labs(colour = "Group",x="",y="% of the Sample")
plot(xtabs(~Group.F+Category,WisMor.long))
library(vcd)
#Importing Packages, Data----
rm(list=ls())
library(tidyverse)
library(tm)
library(stringr)
library(tidytext)
library(kableExtra)
library(ggplot2)
library(kableExtra)
library(ggsci)
library(vcd)
setwd("~/GitHub/wisdom-summit-2021")
raw <- read.csv('2021 Wisdom Summit_August 27, 2021_21.22.csv')
culture<-read.csv('culture.csv')
morality<-read.csv('morality.csv')
total<-raw %>% left_join(culture) %>% left_join(morality)
#Adding Variables ----
total <- total %>% filter(!grepl("progress",Progress, ignore.case = TRUE)) %>%
rename(Duration=Duration..in.seconds.)
total$Duration <- as.numeric(raw$Duration)
total <- total %>%
mutate(filter = ifelse(str_detect(wisdom_culture, "useless|1"), 1, 0)) %>%
mutate(filter = ifelse(!is.na(country) & str_detect(country, "TEST"), 1, filter)) %>%
mutate(filter = ifelse(Duration < 45, 1, filter)) #if they spent less than 45 seconds, remove them
total$filter <- as.factor(total$filter)
# summary(raw$filter)
data <- total %>% filter(filter==0)
data <- data %>%
mutate(position2 = ifelse(position == "Other" &
str_detect(position_8_TEXT,"Lecturer|Emeritus|senior lecturer|On sabbatical"),
"Professor",position))%>%
mutate(position2 = ifelse(position == "Other" &
str_detect(position_8_TEXT, "PhD scholar|RA|scientist|psychologist|Associate"),
"Graduate Student",position2))
# data%>%filter(position == "Other") %>% select(position,position_8_TEXT, education, position2)
USlist <- c("US", "us", "Usa", "United States of America","united States", "United States", "The United States of America")
UKlist <- c("UK","united kingdom", "United Kingdom", "England")
data$country <- data$country %>% str_trim()
data <- data %>%
mutate(country = ifelse(country %in% USlist,"USA", country))%>%
mutate(country = ifelse(country %in% UKlist, "UK", country))%>%
mutate(country = ifelse(country =="BG", "Bulgaria", country)) %>%
mutate(country = ifelse(country =="CHINA", "China", country)) %>%
mutate(country = ifelse(country =="canada", "Canada", country)) %>%
mutate(country = ifelse(country == "HK", "Hong Kong", country)) %>%
mutate(country = ifelse(country == "Russian Federation", "Russia", country)) %>%
mutate(country = ifelse(country == "Viet Nam", "Vietnam", country)) %>%
mutate(country = ifelse(country == "turkey", "Turkey", country))
data <- data %>%
mutate(position2= ifelse(str_detect(position2,"Professor"), "Professor", "Not a Professor"))
data <- data %>%
mutate(CountryCode= ifelse(str_detect(country,"USA|Canada"), "USA & Canada", "Others"))
cols <- c("country","CountryCode","position","position2")
data[,cols] <- lapply(data[,cols],as.factor)
data <- data %>%
mutate_all(na_if,"")
WisMor <- data %>%
filter(!is.na(morality_wis_analogy) |
!is.na(wis_psych_char) |
!is.na(model_agreement) |
!is.na(model_disagree) |
!is.na(wisdom_culture)) %>%
select(CountryCode,Progress, Duration,position2,ResponseId,field,prior_research:education,
moral_to_wis_agree, wis_to_moral_agree, morality_wis_analogy,wis_psych_char,wisdomModelFamiliar) %>%
rename(Position = position2, Education = education, Field = field)
WisMor <- WisMor %>%
mutate(M2W_Relevant = ifelse(str_detect(moral_to_wis_agree, "relevant"), 1, 0))%>%
mutate(M2W_Precursor = ifelse(str_detect(moral_to_wis_agree, "precursor"), 1, 0))%>%
mutate(M2W_Necessary = ifelse(str_detect(moral_to_wis_agree, "necessary"), 1, 0))%>%
mutate(M2W_Sufficient = ifelse(str_detect(moral_to_wis_agree, "sufficient"), 1,0))%>%
mutate(M2W_Unrelated = ifelse(is.na(moral_to_wis_agree), 1, 0))%>%
mutate(W2M_Relevant = ifelse(str_detect(wis_to_moral_agree, "relevant"), 1, 0))%>%
mutate(W2M_Precursor = ifelse(str_detect(wis_to_moral_agree, "precursor"), 1, 0))%>%
mutate(W2M_Necessary = ifelse(str_detect(wis_to_moral_agree, "necessary"), 1, 0))%>%
mutate(W2M_Sufficient = ifelse(str_detect(wis_to_moral_agree, "sufficient"), 1, 0))%>%
mutate(W2M_Unrelated = ifelse(is.na(wis_to_moral_agree), 1, 0)) %>%
mutate(M2W_Relevant = coalesce(M2W_Relevant, 0),
M2W_Precursor = coalesce(M2W_Precursor, 0),
M2W_Necessary = coalesce(M2W_Necessary, 0),
M2W_Sufficient = coalesce(M2W_Sufficient, 0),
W2M_Relevant = coalesce(W2M_Relevant, 0),
W2M_Precursor= coalesce(W2M_Precursor, 0),
W2M_Necessary = coalesce(W2M_Necessary, 0),
W2M_Sufficient = coalesce(W2M_Sufficient, 0))
WisMor.long<-WisMor %>% pivot_longer(M2W_Relevant:W2M_Sufficient,names_sep="_",names_to=c("Group","Category"),values_to="Proportion")
WisMor.long$Group.F[WisMor.long$Group=="M2W"]<-"Morality to Wisdom"
WisMor.long$Group.F[WisMor.long$Group=="W2M"]<-"Wisdom to Morality"
Wis.Mor.Summary<-WisMor.long %>%
group_by(Group.F, Category) %>%
summarise(Prop = mean(Proportion)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Group.F, Percent)
xtabs(~Group.F+Category,WisMor.long)
plot(xtabs(~Group.F+Category,WisMor.long))
agreementplot(xtabs(~Group.F+Category,WisMor.long))
assocstats(xtabs(~Group.F+Category,WisMor.long))
xtabs(Proportion~Group.F+Category,WisMor.long)
plot(xtabs(Proportion~Group.F+Category,WisMor.long))
plot(xtabs(Proportion~Category+Group.F,WisMor.long))
assocstats(xtabs(Proportion~Group.F+Category,WisMor.long))
View(WisMor.long)
Wis.Mor.Summary.position<-WisMor.long %>%
group_by(Position,Group.F, Category) %>%
summarise(Prop = mean(Proportion)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Position,Group.F, Percent)
View(Wis.Mor.Summary.position)
plot(xtabs(Proportion~Category+Group.F+Position,WisMor.long))
assocstats(xtabs(Proportion~Group.F+Category+Position,WisMor.long))
plot(xtabs(Proportion~Category+Group.F+Position,WisMor.long))
plot(xtabs(Proportion~Position+Category+Group.F,WisMor.long))
plot(xtabs(Proportion~Position+Group.F+Category,WisMor.long))
assocstats(xtabs(Proportion~Group.F+Category+Position,WisMor.long))
ggplot(Wis.Mor.Summary.position, aes(x=Category, y=Percent, color=Group.F)) +
geom_point(size=3) +
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(Position)
)
ggplot(Wis.Mor.Summary.position, aes(x=Category, y=Percent, color=Group.F)) +
geom_segment(aes(x=Category,
y=0,
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(Wis.Mor.Summary.position, aes(x=Category, y=Percent, color=Group.F)) +
geom_point(size=3) +
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(Position))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(Wis.Mor.Summary.position, aes(x=Category, y=Percent, color=Group.F)) +
geom_point(size=3) +
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(Position))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggplot(Wis.Mor.Summary.position, aes(x=Category, y=Percent, color=Group.F)) +
geom_point(size=3) +
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(Position))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))++geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="top")+
scale_color_aaas()+ labs(colour = "Group",x="",y="% of the Sample")
ggplot(Wis.Mor.Summary.position, aes(x=Category, y=Percent, color=Group.F)) +
geom_point(size=3) +
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(Position))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))+geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="top")+
scale_color_aaas()+ labs(colour = "Group",x="",y="% of the Sample")
ggplot(Wis.Mor.Summary.position, aes(x=Category, y=Percent, color=Group.F)) +
geom_point(size=3) +
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(Position))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))+geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="top")+
scale_color_aaas()+ labs(colour = "Group",x="",y="% of the Sample")
#Importing Packages, Data----
rm(list=ls())
library(tidyverse)
library(tm)
library(stringr)
library(tidytext)
library(kableExtra)
library(ggplot2)
library(kableExtra)
library(ggsci)
library(vcd)
setwd("~/GitHub/wisdom-summit-2021")
raw <- read.csv('2021 Wisdom Summit_August 27, 2021_21.22.csv')
culture<-read.csv('culture.csv')
morality<-read.csv('morality.csv')
total<-raw %>% left_join(culture) %>% left_join(morality)
#Adding Variables ----
total <- total %>% filter(!grepl("progress",Progress, ignore.case = TRUE)) %>%
rename(Duration=Duration..in.seconds.)
total$Duration <- as.numeric(raw$Duration)
total <- total %>%
mutate(filter = ifelse(str_detect(wisdom_culture, "useless|1"), 1, 0)) %>%
mutate(filter = ifelse(!is.na(country) & str_detect(country, "TEST"), 1, filter)) %>%
mutate(filter = ifelse(Duration < 45, 1, filter)) #if they spent less than 45 seconds, remove them
total$filter <- as.factor(total$filter)
# summary(raw$filter)
data <- total %>% filter(filter==0)
data <- data %>%
mutate(position2 = ifelse(position == "Other" &
str_detect(position_8_TEXT,"Lecturer|Emeritus|senior lecturer|On sabbatical"),
"Professor",position))%>%
mutate(position2 = ifelse(position == "Other" &
str_detect(position_8_TEXT, "PhD scholar|RA|scientist|psychologist|Associate"),
"Graduate Student",position2))
# data%>%filter(position == "Other") %>% select(position,position_8_TEXT, education, position2)
USlist <- c("US", "us", "Usa", "United States of America","united States", "United States", "The United States of America")
UKlist <- c("UK","united kingdom", "United Kingdom", "England")
data$country <- data$country %>% str_trim()
data <- data %>%
mutate(country = ifelse(country %in% USlist,"USA", country))%>%
mutate(country = ifelse(country %in% UKlist, "UK", country))%>%
mutate(country = ifelse(country =="BG", "Bulgaria", country)) %>%
mutate(country = ifelse(country =="CHINA", "China", country)) %>%
mutate(country = ifelse(country =="canada", "Canada", country)) %>%
mutate(country = ifelse(country == "HK", "Hong Kong", country)) %>%
mutate(country = ifelse(country == "Russian Federation", "Russia", country)) %>%
mutate(country = ifelse(country == "Viet Nam", "Vietnam", country)) %>%
mutate(country = ifelse(country == "turkey", "Turkey", country))
data <- data %>%
mutate(position2= ifelse(str_detect(position2,"Professor"), "Professor", "Not a Professor"))
data <- data %>%
mutate(CountryCode= ifelse(str_detect(country,"USA|Canada"), "USA & Canada", "Others"))
cols <- c("country","CountryCode","position","position2")
data[,cols] <- lapply(data[,cols],as.factor)
#Subset Data & No Of Answers ----
data <- data %>%
mutate_all(na_if,"")
WisMor <- data %>%
filter(!is.na(morality_wis_analogy) |
!is.na(wis_psych_char) |
!is.na(model_agreement) |
!is.na(model_disagree) |
!is.na(wisdom_culture)) %>%
select(CountryCode,Progress, Duration,position2,ResponseId,field,prior_research:education,
moral_to_wis_agree, wis_to_moral_agree, morality_wis_analogy,wis_psych_char,wisdomModelFamiliar) %>%
rename(Position = position2, Education = education, Field = field)
WisMor <- WisMor %>%
mutate(M2W_Relevant = ifelse(str_detect(moral_to_wis_agree, "relevant"), 1, 0))%>%
mutate(M2W_Precursor = ifelse(str_detect(moral_to_wis_agree, "precursor"), 1, 0))%>%
mutate(M2W_Necessary = ifelse(str_detect(moral_to_wis_agree, "necessary"), 1, 0))%>%
mutate(M2W_Sufficient = ifelse(str_detect(moral_to_wis_agree, "sufficient"), 1,0))%>%
mutate(M2W_Unrelated = ifelse(is.na(moral_to_wis_agree), 1, 0))%>%
mutate(W2M_Relevant = ifelse(str_detect(wis_to_moral_agree, "relevant"), 1, 0))%>%
mutate(W2M_Precursor = ifelse(str_detect(wis_to_moral_agree, "precursor"), 1, 0))%>%
mutate(W2M_Necessary = ifelse(str_detect(wis_to_moral_agree, "necessary"), 1, 0))%>%
mutate(W2M_Sufficient = ifelse(str_detect(wis_to_moral_agree, "sufficient"), 1, 0))%>%
mutate(W2M_Unrelated = ifelse(is.na(wis_to_moral_agree), 1, 0)) %>%
mutate(M2W_Relevant = coalesce(M2W_Relevant, 0),
M2W_Precursor = coalesce(M2W_Precursor, 0),
M2W_Necessary = coalesce(M2W_Necessary, 0),
M2W_Sufficient = coalesce(M2W_Sufficient, 0),
W2M_Relevant = coalesce(W2M_Relevant, 0),
W2M_Precursor= coalesce(W2M_Precursor, 0),
W2M_Necessary = coalesce(W2M_Necessary, 0),
W2M_Sufficient = coalesce(W2M_Sufficient, 0))
WisMor.long<-WisMor %>% pivot_longer(M2W_Relevant:W2M_Sufficient,names_sep="_",names_to=c("Group","Category"),values_to="Proportion")
WisMor.long$Group.F[WisMor.long$Group=="M2W"]<-"Morality to Wisdom"
WisMor.long$Group.F[WisMor.long$Group=="W2M"]<-"Wisdom to Morality"
Wis.Mor.Summary<-WisMor.long %>%
group_by(Group.F, Category) %>%
summarise(Prop = mean(Proportion)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(Group.F, Percent)
morals <- Wis.Mor.Summary %>%
# 1. Remove grouping
ungroup() %>%
# 2. Arrange by
#   i.  facet group
#   ii. bar height
arrange(Group.F, Percent) %>%
# 3. Add order column of row numbers
mutate(order = row_number())
#lollipop chart
morals %>% ggplot(aes(x=order, y=Percent, color=Group.F)) +
geom_point(size=3) +
geom_segment(aes(x=order,
xend=order,
y=0,
yend=Percent)) +facet_wrap(vars(Group.F), scales = "free")+
scale_x_continuous(   # Add categories to axis
breaks = morals$order,
labels = morals$Category)+theme_minimal(base_size = 14) +geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="none")+
scale_color_aaas()+ labs(colour = "Group",x="",y="% of the Sample")
xtabs(Proportion~Group.F+Category,WisMor.long)
plot(xtabs(Proportion~Category+Group.F,WisMor.long))
assocstats(xtabs(Proportion~Group.F+Category,WisMor.long))
Wis.Mor.Summary.country<-WisMor.long %>%
filter(!is.na(CountryCode))%>%
group_by(CountryCode,Group.F, Category) %>%
summarise(Prop = mean(Proportion)) %>%
mutate(Percent = Prop*100) %>% ungroup() %>%  arrange(CountryCode,Group.F, Percent)
plot(xtabs(Proportion~CountryCode+Group.F+Category,WisMor.long))
assocstats(xtabs(Proportion~Group.F+Category+CountryCode,WisMor.long))
ggplot(Wis.Mor.Summary.country, aes(x=Category, y=Percent, color=Group.F)) +
geom_point(size=3) +
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(CountryCode))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))+geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="top")+
scale_color_aaas()+ labs(colour = "Group",x="",y="% of the Sample")
ggplot(Wis.Mor.Summary.country, aes(x=Category, y=Percent, color=Group.F)) +
geom_point(size=3) +
geom_segment(aes(x=Category,
xend=Category,
y=0,
yend=Percent)) + facet_wrap(vars(CountryCode))+
theme(axis.text.x = element_text(angle=65, vjust=0.6))+geom_hline(yintercept =50, linetype='dashed', color='black', 14)+theme(legend.position="top")+
scale_color_aaas()+ labs(colour = "Group",x="",y="% of the Sample")
#how many responses?
length(WisMor$M2W_Necessary)
names(data)
#Importing Packages, Data----
rm(list=ls())
library(tidyverse)
library(tm)
library(stringr)
library(tidytext)
library(kableExtra)
library(ggplot2)
library(kableExtra)
library(ggsci)
library(vcd)
setwd("~/GitHub/wisdom-summit-2021")
raw <- read.csv('2021 Wisdom Summit_August 27, 2021_21.22.csv')
culture<-read.csv('culture.csv')
morality<-read.csv('morality.csv')
total<-raw %>% left_join(culture) %>% left_join(morality)
#Adding Variables ----
total <- total %>% filter(!grepl("progress",Progress, ignore.case = TRUE)) %>%
rename(Duration=Duration..in.seconds.)
total$Duration <- as.numeric(raw$Duration)
total <- total %>%
mutate(filter = ifelse(str_detect(wisdom_culture, "useless|1"), 1, 0)) %>%
mutate(filter = ifelse(!is.na(country) & str_detect(country, "TEST"), 1, filter)) %>%
mutate(filter = ifelse(Duration < 45, 1, filter)) #if they spent less than 45 seconds, remove them
total$filter <- as.factor(total$filter)
# summary(raw$filter)
data <- total %>% filter(filter==0)
data <- data %>%
mutate(position2 = ifelse(position == "Other" &
str_detect(position_8_TEXT,"Lecturer|Emeritus|senior lecturer|On sabbatical"),
"Professor",position))%>%
mutate(position2 = ifelse(position == "Other" &
str_detect(position_8_TEXT, "PhD scholar|RA|scientist|psychologist|Associate"),
"Graduate Student",position2))
# data%>%filter(position == "Other") %>% select(position,position_8_TEXT, education, position2)
USlist <- c("US", "us", "Usa", "United States of America","united States", "United States", "The United States of America")
UKlist <- c("UK","united kingdom", "United Kingdom", "England")
data$country <- data$country %>% str_trim()
data <- data %>%
mutate(country = ifelse(country %in% USlist,"USA", country))%>%
mutate(country = ifelse(country %in% UKlist, "UK", country))%>%
mutate(country = ifelse(country =="BG", "Bulgaria", country)) %>%
mutate(country = ifelse(country =="CHINA", "China", country)) %>%
mutate(country = ifelse(country =="canada", "Canada", country)) %>%
mutate(country = ifelse(country == "HK", "Hong Kong", country)) %>%
mutate(country = ifelse(country == "Russian Federation", "Russia", country)) %>%
mutate(country = ifelse(country == "Viet Nam", "Vietnam", country)) %>%
mutate(country = ifelse(country == "turkey", "Turkey", country))
data <- data %>%
mutate(position2= ifelse(str_detect(position2,"Professor"), "Professor", "Not a Professor"))
data <- data %>%
mutate(CountryCode= ifelse(str_detect(country,"USA|Canada"), "USA & Canada", "Others"))
cols <- c("country","CountryCode","position","position2")
data[,cols] <- lapply(data[,cols],as.factor)
data <- data %>%
mutate_all(na_if,"")
Moral.open <- data %>%
filter(!is.na(morality_wis_analogy) |
!is.na(moral_wis_comments) |
!is.na(wis_psych_char)) %>%
select(CountryCode,Progress, Duration,position2,ResponseId,field,prior_research:education,
FRMW_FINAL,  FRWM_FINAL, FRJF_FINAL,TRMW_FINAL,TRWM_FINAL,TRHOC_FINAL,PR_FINAL,DR_FINAL,FM_FINAL,PROCESS.MECH_FINAL,PROCESS.LIFE_FINAL,CONSTRUCT_FINAL)%>%
rename(Position = position2, Education = education, Field = field)
#how many responses?
length(Moral.open$FRMW_FINAL)
VIew(Moral.open)
View(Moral.open)
Moral.open <- data %>%
filter(!is.na(morality_wis_analogy) |
!is.na(moral_wis_comments) |
!is.na(wis_psych_char)) %>%
select(CountryCode,Progress, Duration,position2,ResponseId,field,prior_research:education,moral_wis_comments,morality_wis_analogy,wis_psych_char,
FRMW_FINAL,  FRWM_FINAL, FRJF_FINAL,TRMW_FINAL,TRWM_FINAL,TRHOC_FINAL,PR_FINAL,DR_FINAL,FM_FINAL,PROCESS.MECH_FINAL,PROCESS.LIFE_FINAL,CONSTRUCT_FINAL)%>%
rename(Position = position2, Education = education, Field = field)
View(Moral.open)
Moral.open <- data %>%
filter(!is.na(FRMW_FINAL)) %>%
select(CountryCode,Progress, Duration,position2,ResponseId,field,prior_research:education,moral_wis_comments,morality_wis_analogy,wis_psych_char,
FRMW_FINAL,  FRWM_FINAL, FRJF_FINAL,TRMW_FINAL,TRWM_FINAL,TRHOC_FINAL,PR_FINAL,DR_FINAL,FM_FINAL,PROCESS.MECH_FINAL,PROCESS.LIFE_FINAL,CONSTRUCT_FINAL)%>%
rename(Position = position2, Education = education, Field = field)
#how many responses?
length(Moral.open$FRMW_FINAL)
